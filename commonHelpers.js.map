{"version":3,"file":"commonHelpers.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nimport { refs, onError, MESSAGE } from '../main';\nimport { perPage } from './pixabay-api';\n\n\nexport let totalHits;\nexport let lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionPosition: 'bottom',\n  captionDelay: 250,\n});;\n\nexport  function makeGalleryItem(res) {\n    const result = res.hits.map(makeMarcup).join('');\n    totalHits = res.totalHits\n      if (totalHits > perPage) {\n        refs.btnLoad.classList.remove('hidden');\n    }\n      if (res.hits.length) {\n        refs.galleryList.insertAdjacentHTML('beforeend', result);\n      } else {\n        onError(MESSAGE);\n      }\n\n      lightbox.refresh();\n  }\n\n  function makeMarcup(image) {\n    return `<li class=\"gallery-item\">\n          <a href=\"${image.largeImageURL}\" class=\"gallery-link\">\n            <img\n              src=\"${image.webformatURL}\"\n              class=\"gallery-image\"\n              alt=\"${image.tags}\"\n            />\n          </a>\n          <div class=\"modat-text\">\n          \n              <div class=\"modal-element\"><p>Likes</p><span>${image.likes}</span></div>\n              <div class=\"modal-element\"><p>Views</p><span>${image.views}</span></div>\n              <div class=\"modal-element\"><p>Comments</p><span>${image.comments}</span></div>\n              <div class=\"modal-element\"><p>Downloads</p><span>${image.downloads}</span></div>\n          </div>\n        </li>`;\n  }\n    \n    ","import axios from \"axios\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport { refs, onError, LIMIT, loaderOff, loaderOn } from \"../main\";\nimport { makeGalleryItem, totalHits, lightbox } from './render-functions';\nimport { MESSAGE } from \"../main\";\n\nexport const perPage = 15;\nexport let page;\nexport let userSearch;\n\nexport async function fetchImg(userInput) {\n    loaderOn();\n    axios.defaults.baseURL = 'https://pixabay.com/api/';\n    const API_KEY = '42320783-7d0430ad6756cac4c8b613a39';\n    const PARAMS = `q=${userInput}&image_type=photo&orientation=horizontal&safesearch=true`;\n    const URL = `?key=${API_KEY}&${PARAMS}`;\n\n    const config = {\n        params: {\n            per_page: perPage,\n            page: page,\n        },\n    };\n\n    const res = await axios.get(URL, config);\n    return res.data;\n}\n\nexport async function onFormSubmit(event) {\n    event.preventDefault();\n    loaderOn();\n    refs.btnLoad.classList.add('hidden');\n\n    refs.galleryList.innerHTML = '';\n    page = 1;\n    userSearch = event.target.elements.input.value.trim();\n    if (userSearch) {\n      try {\n        const responce = await fetchImg(userSearch);\n        const item = makeGalleryItem(responce);\n        return item;\n      } catch (error) {\n        onError(MESSAGE);\n      } finally {\n        loaderOff();\n        refs.userForm.reset();\n      }\n    } else {\n      refs.userForm.elements.input.value = '';\n      onError(CORRECT);\n    }\n  }\n\nexport async function onLoadClick() {\n    page += 1;\n    const maxPage = Math.ceil(totalHits / perPage);\n    if (page >= maxPage) {\n        refs.btnLoad.classList.add('hidden');\n        onError(LIMIT);\n    } else {\n        const result = await fetchImg(userSearch);\n        const element = makeGalleryItem(result);\n        scrollPage();\n        loaderOff();\n        lightbox.refresh();\n        return element;\n    }\n}\n\nfunction scrollPage() {\n    const rect = refs.galleryList.firstElementChild.getBoundingClientRect();\n    const size = rect.height * 2;\n    window.scrollBy({top: size, left: 0, behavior: 'smooth'});\n}","// Описаний у документації\nimport iziToast from \"izitoast\";\n// Додатковий імпорт стилів\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nimport  './js/pixabay-api';\nimport './js/render-functions';\nimport { onFormSubmit, onLoadClick } from './js/pixabay-api';\n\nexport const refs = {\n    userForm: document.querySelector('.user-form'),\n    userInput: document.querySelector('.user-input'),\n    btn: document.querySelector('.form-button'),\n    galleryList: document.querySelector('.gallery'),\n    container: document.querySelector('.container'),\n    loader: document.querySelector('.loader'),\n    btnLoad: document.querySelector('.btn-load'),\n  };\n\n  refs.userForm.addEventListener('submit', onFormSubmit);\n  refs.btnLoad.addEventListener('click', onLoadClick);\n\n  export function loaderOn() {\n    refs.loader.classList.remove('hidden');\n  }\n  \n  export function loaderOff() {\n    refs.loader.classList.add('hidden');\n  }\n\n  export function onError(message) {\n    iziToast.error({\n    message: message,\n    position: 'topRight',\n    });\n}\n\n      export const LIMIT = \"We're sorry, but you've reached the end of search results.\";\n      export const CORRECT = 'Please enter correct information.';\n      export const MESSAGE = 'Sorry, there are no images matching your search query. Please try again!';"],"names":["totalHits","lightbox","SimpleLightbox","makeGalleryItem","res","result","makeMarcup","perPage","refs","onError","MESSAGE","image","page","userSearch","fetchImg","userInput","loaderOn","axios","API_KEY","PARAMS","URL","config","onFormSubmit","event","responce","loaderOff","onLoadClick","maxPage","LIMIT","element","scrollPage","size","message","iziToast"],"mappings":"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"}